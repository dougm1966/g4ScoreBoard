<!doctype html>
<html>
<head>
	<!-- CRITICAL: Theme stylesheets MUST stay in this exact order -->
	<!-- obsThemeChange() uses document.styleSheets[0..5] indices -->
	<link rel="stylesheet" href="./common/css/control_panel/yami.css" />
	<link rel="stylesheet" href="./common/css/control_panel/dark.css" />
	<link rel="stylesheet" href="./common/css/control_panel/acri.css" />
	<link rel="stylesheet" href="./common/css/control_panel/grey.css" />
	<link rel="stylesheet" href="./common/css/control_panel/light.css" />
	<link rel="stylesheet" href="./common/css/control_panel/rachni.css" />
	<!-- New CSS files (loaded after themes) -->
	<link rel="stylesheet" href="./common/css/control_panel/base.css" />
	<link rel="stylesheet" href="./common/css/control_panel/layout.css" />
	<link rel="stylesheet" href="./common/css/control_panel/components.css" />
	<link rel="stylesheet" href="./common/css/control_panel/required.css" />

	<style>
		#FileUploadAdTop1, #FileUploadAdTop2, #FileUploadAdTop3, #FileUploadAdTop4, #FileUploadAdTop5, #FileUploadAdTop6,
		#FileUploadAdLeft1, #FileUploadAdLeft2, #FileUploadAdLeft3,
		#FileUploadAdRight1, #FileUploadAdRight2, #FileUploadAdRight3 {
			display: none;
		}

		.ads-row {
			display: grid;
			grid-template-columns: 28px 1fr;
			gap: 8px;
			align-items: center;
			padding: 6px 0;
		}

		.ads-row__label {
			font-weight: 600;
			color: var(--text-primary);
			text-align: center;
		}

		.ads-row__controls {
			display: flex;
			flex-wrap: wrap;
			gap: 8px;
			align-items: center;
		}

		.ads-row--blocked {
			opacity: 0.45;
			filter: grayscale(1);
		}

		.ads-row--blocked .btn,
		.ads-row--blocked input,
		.ads-row--blocked select {
			pointer-events: none;
		}

		.ads-span {
			width: 54px;
		}

		.ads-dims {
			font-size: 11px;
			color: var(--text-secondary, #888);
			white-space: nowrap;
		}

		.ads-title {
			flex: 1 1 100%;
			min-width: 140px;
		}

		.ad-preview {
			position: relative;
			flex: 1 1 100%;
			width: 100%;
			height: 56px;
			border-radius: 8px;
			overflow: hidden;
			background: rgba(0, 0, 0, 0.15);
			border: 1px solid rgba(255, 255, 255, 0.08);
			box-sizing: border-box;
		}

		.ad-preview img {
			width: 100%;
			height: 100%;
			object-fit: contain;
			display: block;
		}

		.ad-preview__delete {
			position: absolute;
			top: 4px;
			right: 6px;
			width: 18px;
			height: 18px;
			border-radius: 999px;
			background: rgba(0, 0, 0, 0.55);
			border: 1px solid rgba(255, 255, 255, 0.2);
			color: rgba(255, 255, 255, 0.9);
			display: flex;
			align-items: center;
			justify-content: center;
			font-weight: 700;
			cursor: pointer;
			user-select: none;
			line-height: 1;
		}
	</style>

	<script src="./common/js/jquery.js"></script>
	<script src="./common/js/idb_images.js"></script>
	<script src="./common/js/advertising_control_panel.js"></script>
	<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
</head>
<body onload="adsInit()">
	<header class="panel-header">
		<span class="version-text">Advertising</span>
	</header>

	<div id="mainDiv">
		<section class="section-card" id="adsSection">
			<div class="section-card__title">Advertising</div>

			<div class="checkbox-row">
				<div style="display:flex; align-items:center; gap:12px; flex-wrap:wrap;">
					<label class="checkbox-label" style="margin:0;">
						<input type="checkbox" class="smallSize" id="adsFrameArtChk" onchange="adsToggleFrameArt()">
						<span>Frame Art</span>
					</label>
					<label class="checkbox-label" style="margin:0; display:flex; align-items:center; gap:8px;">
						<span>Background</span>
						<input type="color" id="adsFrameBgColor" value="#000000" oninput="adsSetFrameBgColor(this.value)" style="width:40px; height:24px; padding:0; border:none; background:transparent;">
						<input type="range" id="adsFrameBgAlpha" min="0" max="100" step="1" value="0" oninput="adsSetFrameBgAlpha(this.value)" style="width:140px;">
						<span id="adsFrameBgAlphaLabel" style="min-width:44px; text-align:right;">0%</span>
					</label>
				</div>
			</div>

			<div class="grid-section" style="grid-template-columns: 1fr 1fr; gap: var(--grid-gap);">
				<div class="btn btn--primary hover obs28" id="adsRefreshBtn" onclick="adsRefresh()">Refresh Ads</div>
				<div class="btn hover obs28" id="adsAdvancedToggleBtn" onclick="adsToggleAdvanced()">Advanced</div>
			</div>

			<div class="grid-section grid-cols-1 noShow" id="adsAdvancedPanel">
				<div class="grid-section" style="grid-template-columns: 1fr 1fr; gap: var(--grid-gap);">
					<div class="btn hover obs28" onclick="adsLoadIntoEditor()">Load Layout</div>
					<div class="btn btn--primary hover obs28" onclick="adsSaveFromEditor()">Save Layout</div>
				</div>
				<textarea id="adsLayoutJson" class="input-field" style="height: 180px; font-family: monospace;"></textarea>
			</div>

			<div class="grid-section grid-cols-1" id="adsRows">
				<div class="ads-row" data-region="top" data-index="1">
					<div class="ads-row__label">T1</div>
					<div class="ads-row__controls">
						<div class="btn tooltip hover obs28" onclick="triggerAdUpload('top',1)">
							<input type="file" id="FileUploadAdTop1" onchange="adPost(this,'top',1)" accept="image/png, image/jpeg, image/svg+xml, image/bmp" />
							Upload
						</div>
						<select class="select-field ads-span obs28" id="adTop1Span" onchange="adsSetSpan('top',1,this.value)">
							<option value="1">1</option>
							<option value="2">2</option>
							<option value="3">3</option>
						</select>
						<label class="checkbox-label">
							<input type="checkbox" class="smallSize" id="adTop1Frame" onchange="adsSetFrame('top',1,this.checked)">
							<span>Frame</span>
						</label>
						<label class="checkbox-label">
							<input type="checkbox" class="smallSize" id="adTop1Show" checked onchange="adsSetShow('top',1,this.checked)">
							<span>Show</span>
						</label>
						<span class="ads-dims" id="adTop1Dims">320×180</span>
						<div class="ad-preview noShow" id="adTop1Preview">
							<div class="ad-preview__delete" onclick="adsDeleteAd('top',1)">X</div>
							<img id="adTop1Img" src="" alt="">
						</div>
						<input type="text" class="input-field ads-title" id="adTop1Title" placeholder="Title (optional)" oninput="adsSetTitle('top',1,this.value)">
					</div>
				</div>

				<div class="ads-row" data-region="top" data-index="2">
					<div class="ads-row__label">T2</div>
					<div class="ads-row__controls">
						<div class="btn tooltip hover obs28" onclick="triggerAdUpload('top',2)">
							<input type="file" id="FileUploadAdTop2" onchange="adPost(this,'top',2)" accept="image/png, image/jpeg, image/svg+xml, image/bmp" />
							Upload
						</div>
						<select class="select-field ads-span obs28" id="adTop2Span" onchange="adsSetSpan('top',2,this.value)">
							<option value="1">1</option>
							<option value="2">2</option>
							<option value="3">3</option>
						</select>
						<label class="checkbox-label">
							<input type="checkbox" class="smallSize" id="adTop2Frame" onchange="adsSetFrame('top',2,this.checked)">
							<span>Frame</span>
						</label>
						<label class="checkbox-label">
							<input type="checkbox" class="smallSize" id="adTop2Show" checked onchange="adsSetShow('top',2,this.checked)">
							<span>Show</span>
						</label>
						<span class="ads-dims" id="adTop2Dims">320×180</span>
						<div class="ad-preview noShow" id="adTop2Preview">
							<div class="ad-preview__delete" onclick="adsDeleteAd('top',2)">X</div>
							<img id="adTop2Img" src="" alt="">
						</div>
						<input type="text" class="input-field ads-title" id="adTop2Title" placeholder="Title (optional)" oninput="adsSetTitle('top',2,this.value)">
					</div>
				</div>

				<div class="ads-row" data-region="top" data-index="3">
					<div class="ads-row__label">T3</div>
					<div class="ads-row__controls">
						<div class="btn tooltip hover obs28" onclick="triggerAdUpload('top',3)">
							<input type="file" id="FileUploadAdTop3" onchange="adPost(this,'top',3)" accept="image/png, image/jpeg, image/svg+xml, image/bmp" />
							Upload
						</div>
						<select class="select-field ads-span obs28" id="adTop3Span" onchange="adsSetSpan('top',3,this.value)">
							<option value="1">1</option>
							<option value="2">2</option>
							<option value="3">3</option>
						</select>
						<label class="checkbox-label">
							<input type="checkbox" class="smallSize" id="adTop3Frame" onchange="adsSetFrame('top',3,this.checked)">
							<span>Frame</span>
						</label>
						<label class="checkbox-label">
							<input type="checkbox" class="smallSize" id="adTop3Show" checked onchange="adsSetShow('top',3,this.checked)">
							<span>Show</span>
						</label>
						<span class="ads-dims" id="adTop3Dims">320×180</span>
						<div class="ad-preview noShow" id="adTop3Preview">
							<div class="ad-preview__delete" onclick="adsDeleteAd('top',3)">X</div>
							<img id="adTop3Img" src="" alt="">
						</div>
						<input type="text" class="input-field ads-title" id="adTop3Title" placeholder="Title (optional)" oninput="adsSetTitle('top',3,this.value)">
					</div>
				</div>

				<div class="ads-row" data-region="top" data-index="4">
					<div class="ads-row__label">T4</div>
					<div class="ads-row__controls">
						<div class="btn tooltip hover obs28" onclick="triggerAdUpload('top',4)">
							<input type="file" id="FileUploadAdTop4" onchange="adPost(this,'top',4)" accept="image/png, image/jpeg, image/svg+xml, image/bmp" />
							Upload
						</div>
						<select class="select-field ads-span obs28" id="adTop4Span" onchange="adsSetSpan('top',4,this.value)">
							<option value="1">1</option>
							<option value="2">2</option>
							<option value="3">3</option>
						</select>
						<label class="checkbox-label">
							<input type="checkbox" class="smallSize" id="adTop4Frame" onchange="adsSetFrame('top',4,this.checked)">
							<span>Frame</span>
						</label>
						<label class="checkbox-label">
							<input type="checkbox" class="smallSize" id="adTop4Show" checked onchange="adsSetShow('top',4,this.checked)">
							<span>Show</span>
						</label>
						<span class="ads-dims" id="adTop4Dims">320×180</span>
						<div class="ad-preview noShow" id="adTop4Preview">
							<div class="ad-preview__delete" onclick="adsDeleteAd('top',4)">X</div>
							<img id="adTop4Img" src="" alt="">
						</div>
						<input type="text" class="input-field ads-title" id="adTop4Title" placeholder="Title (optional)" oninput="adsSetTitle('top',4,this.value)">
					</div>
				</div>

				<div class="ads-row" data-region="top" data-index="5">
					<div class="ads-row__label">T5</div>
					<div class="ads-row__controls">
						<div class="btn tooltip hover obs28" onclick="triggerAdUpload('top',5)">
							<input type="file" id="FileUploadAdTop5" onchange="adPost(this,'top',5)" accept="image/png, image/jpeg, image/svg+xml, image/bmp" />
							Upload
						</div>
						<select class="select-field ads-span obs28" id="adTop5Span" onchange="adsSetSpan('top',5,this.value)">
							<option value="1">1</option>
							<option value="2">2</option>
							<option value="3">3</option>
						</select>
						<label class="checkbox-label">
							<input type="checkbox" class="smallSize" id="adTop5Frame" onchange="adsSetFrame('top',5,this.checked)">
							<span>Frame</span>
						</label>
						<label class="checkbox-label">
							<input type="checkbox" class="smallSize" id="adTop5Show" checked onchange="adsSetShow('top',5,this.checked)">
							<span>Show</span>
						</label>
						<span class="ads-dims" id="adTop5Dims">320×180</span>
						<div class="ad-preview noShow" id="adTop5Preview">
							<div class="ad-preview__delete" onclick="adsDeleteAd('top',5)">X</div>
							<img id="adTop5Img" src="" alt="">
						</div>
						<input type="text" class="input-field ads-title" id="adTop5Title" placeholder="Title (optional)" oninput="adsSetTitle('top',5,this.value)">
					</div>
				</div>

				<div class="ads-row" data-region="top" data-index="6">
					<div class="ads-row__label">T6</div>
					<div class="ads-row__controls">
						<div class="btn tooltip hover obs28" onclick="triggerAdUpload('top',6)">
							<input type="file" id="FileUploadAdTop6" onchange="adPost(this,'top',6)" accept="image/png, image/jpeg, image/svg+xml, image/bmp" />
							Upload
						</div>
						<select class="select-field ads-span obs28" id="adTop6Span" onchange="adsSetSpan('top',6,this.value)">
							<option value="1">1</option>
							<option value="2">2</option>
							<option value="3">3</option>
						</select>
						<label class="checkbox-label">
							<input type="checkbox" class="smallSize" id="adTop6Frame" onchange="adsSetFrame('top',6,this.checked)">
							<span>Frame</span>
						</label>
						<label class="checkbox-label">
							<input type="checkbox" class="smallSize" id="adTop6Show" checked onchange="adsSetShow('top',6,this.checked)">
							<span>Show</span>
						</label>
						<span class="ads-dims" id="adTop6Dims">320×180</span>
						<div class="ad-preview noShow" id="adTop6Preview">
							<div class="ad-preview__delete" onclick="adsDeleteAd('top',6)">X</div>
							<img id="adTop6Img" src="" alt="">
						</div>
						<input type="text" class="input-field ads-title" id="adTop6Title" placeholder="Title (optional)" oninput="adsSetTitle('top',6,this.value)">
					</div>
				</div>

				<div class="ads-row" data-region="left" data-index="1">
					<div class="ads-row__label">L1</div>
					<div class="ads-row__controls">
						<div class="btn tooltip hover obs28" onclick="triggerAdUpload('left',1)">
							<input type="file" id="FileUploadAdLeft1" onchange="adPost(this,'left',1)" accept="image/png, image/jpeg, image/svg+xml, image/bmp" />
							Upload
						</div>
						<select class="select-field ads-span obs28" id="adLeft1Span" onchange="adsSetSpan('left',1,this.value)">
							<option value="1">1</option>
							<option value="2">2</option>
							<option value="3">3</option>
						</select>
						<label class="checkbox-label">
							<input type="checkbox" class="smallSize" id="adLeft1Frame" onchange="adsSetFrame('left',1,this.checked)">
							<span>Frame</span>
						</label>
						<label class="checkbox-label">
							<input type="checkbox" class="smallSize" id="adLeft1Show" checked onchange="adsSetShow('left',1,this.checked)">
							<span>Show</span>
						</label>
						<span class="ads-dims" id="adLeft1Dims">320×360</span>
						<div class="ad-preview noShow" id="adLeft1Preview">
							<div class="ad-preview__delete" onclick="adsDeleteAd('left',1)">X</div>
							<img id="adLeft1Img" src="" alt="">
						</div>
						<input type="text" class="input-field ads-title" id="adLeft1Title" placeholder="Title (optional)" oninput="adsSetTitle('left',1,this.value)">
					</div>
				</div>

				<div class="ads-row" data-region="left" data-index="2">
					<div class="ads-row__label">L2</div>
					<div class="ads-row__controls">
						<div class="btn tooltip hover obs28" onclick="triggerAdUpload('left',2)">
							<input type="file" id="FileUploadAdLeft2" onchange="adPost(this,'left',2)" accept="image/png, image/jpeg, image/svg+xml, image/bmp" />
							Upload
						</div>
						<select class="select-field ads-span obs28" id="adLeft2Span" onchange="adsSetSpan('left',2,this.value)">
							<option value="1">1</option>
							<option value="2">2</option>
							<option value="3">3</option>
						</select>
						<label class="checkbox-label">
							<input type="checkbox" class="smallSize" id="adLeft2Frame" onchange="adsSetFrame('left',2,this.checked)">
							<span>Frame</span>
						</label>
						<label class="checkbox-label">
							<input type="checkbox" class="smallSize" id="adLeft2Show" checked onchange="adsSetShow('left',2,this.checked)">
							<span>Show</span>
						</label>
						<span class="ads-dims" id="adLeft2Dims">320×360</span>
						<div class="ad-preview noShow" id="adLeft2Preview">
							<div class="ad-preview__delete" onclick="adsDeleteAd('left',2)">X</div>
							<img id="adLeft2Img" src="" alt="">
						</div>
						<input type="text" class="input-field ads-title" id="adLeft2Title" placeholder="Title (optional)" oninput="adsSetTitle('left',2,this.value)">
					</div>
				</div>

				<div class="ads-row" data-region="left" data-index="3">
					<div class="ads-row__label">L3</div>
					<div class="ads-row__controls">
						<div class="btn tooltip hover obs28" onclick="triggerAdUpload('left',3)">
							<input type="file" id="FileUploadAdLeft3" onchange="adPost(this,'left',3)" accept="image/png, image/jpeg, image/svg+xml, image/bmp" />
							Upload
						</div>
						<select class="select-field ads-span obs28" id="adLeft3Span" onchange="adsSetSpan('left',3,this.value)">
							<option value="1">1</option>
							<option value="2">2</option>
							<option value="3">3</option>
						</select>
						<label class="checkbox-label">
							<input type="checkbox" class="smallSize" id="adLeft3Frame" onchange="adsSetFrame('left',3,this.checked)">
							<span>Frame</span>
						</label>
						<label class="checkbox-label">
							<input type="checkbox" class="smallSize" id="adLeft3Show" checked onchange="adsSetShow('left',3,this.checked)">
							<span>Show</span>
						</label>
						<span class="ads-dims" id="adLeft3Dims">320×360</span>
						<div class="ad-preview noShow" id="adLeft3Preview">
							<div class="ad-preview__delete" onclick="adsDeleteAd('left',3)">X</div>
							<img id="adLeft3Img" src="" alt="">
						</div>
						<input type="text" class="input-field ads-title" id="adLeft3Title" placeholder="Title (optional)" oninput="adsSetTitle('left',3,this.value)">
					</div>
				</div>

				<div class="ads-row" data-region="right" data-index="1">
					<div class="ads-row__label">R1</div>
					<div class="ads-row__controls">
						<div class="btn tooltip hover obs28" onclick="triggerAdUpload('right',1)">
							<input type="file" id="FileUploadAdRight1" onchange="adPost(this,'right',1)" accept="image/png, image/jpeg, image/svg+xml, image/bmp" />
							Upload
						</div>
						<select class="select-field ads-span obs28" id="adRight1Span" onchange="adsSetSpan('right',1,this.value)">
							<option value="1">1</option>
							<option value="2">2</option>
							<option value="3">3</option>
						</select>
						<label class="checkbox-label">
							<input type="checkbox" class="smallSize" id="adRight1Frame" onchange="adsSetFrame('right',1,this.checked)">
							<span>Frame</span>
						</label>
						<label class="checkbox-label">
							<input type="checkbox" class="smallSize" id="adRight1Show" checked onchange="adsSetShow('right',1,this.checked)">
							<span>Show</span>
						</label>
						<span class="ads-dims" id="adRight1Dims">320×360</span>
						<div class="ad-preview noShow" id="adRight1Preview">
							<div class="ad-preview__delete" onclick="adsDeleteAd('right',1)">X</div>
							<img id="adRight1Img" src="" alt="">
						</div>
						<input type="text" class="input-field ads-title" id="adRight1Title" placeholder="Title (optional)" oninput="adsSetTitle('right',1,this.value)">
					</div>
				</div>

				<div class="ads-row" data-region="right" data-index="2">
					<div class="ads-row__label">R2</div>
					<div class="ads-row__controls">
						<div class="btn tooltip hover obs28" onclick="triggerAdUpload('right',2)">
							<input type="file" id="FileUploadAdRight2" onchange="adPost(this,'right',2)" accept="image/png, image/jpeg, image/svg+xml, image/bmp" />
							Upload
						</div>
						<select class="select-field ads-span obs28" id="adRight2Span" onchange="adsSetSpan('right',2,this.value)">
							<option value="1">1</option>
							<option value="2">2</option>
							<option value="3">3</option>
						</select>
						<label class="checkbox-label">
							<input type="checkbox" class="smallSize" id="adRight2Frame" onchange="adsSetFrame('right',2,this.checked)">
							<span>Frame</span>
						</label>
						<label class="checkbox-label">
							<input type="checkbox" class="smallSize" id="adRight2Show" checked onchange="adsSetShow('right',2,this.checked)">
							<span>Show</span>
						</label>
						<span class="ads-dims" id="adRight2Dims">320×360</span>
						<div class="ad-preview noShow" id="adRight2Preview">
							<div class="ad-preview__delete" onclick="adsDeleteAd('right',2)">X</div>
							<img id="adRight2Img" src="" alt="">
						</div>
						<input type="text" class="input-field ads-title" id="adRight2Title" placeholder="Title (optional)" oninput="adsSetTitle('right',2,this.value)">
					</div>
				</div>

				<div class="ads-row" data-region="right" data-index="3">
					<div class="ads-row__label">R3</div>
					<div class="ads-row__controls">
						<div class="btn tooltip hover obs28" onclick="triggerAdUpload('right',3)">
							<input type="file" id="FileUploadAdRight3" onchange="adPost(this,'right',3)" accept="image/png, image/jpeg, image/svg+xml, image/bmp" />
							Upload
						</div>
						<select class="select-field ads-span obs28" id="adRight3Span" onchange="adsSetSpan('right',3,this.value)">
							<option value="1">1</option>
							<option value="2">2</option>
							<option value="3">3</option>
						</select>
						<label class="checkbox-label">
							<input type="checkbox" class="smallSize" id="adRight3Frame" onchange="adsSetFrame('right',3,this.checked)">
							<span>Frame</span>
						</label>
						<label class="checkbox-label">
							<input type="checkbox" class="smallSize" id="adRight3Show" checked onchange="adsSetShow('right',3,this.checked)">
							<span>Show</span>
						</label>
						<span class="ads-dims" id="adRight3Dims">320×360</span>
						<div class="ad-preview noShow" id="adRight3Preview">
							<div class="ad-preview__delete" onclick="adsDeleteAd('right',3)">X</div>
							<img id="adRight3Img" src="" alt="">
						</div>
						<input type="text" class="input-field ads-title" id="adRight3Title" placeholder="Title (optional)" oninput="adsSetTitle('right',3,this.value)">
					</div>
				</div>
			</div>
		</section>
	</div>
</body>
</html>
